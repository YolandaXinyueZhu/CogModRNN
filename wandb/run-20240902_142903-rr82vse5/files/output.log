
Training with beta_scale: 3.0 and penalty_scale: 1e-10
















































Step 500 of 500; Loss: 4.2751e+04. Model Size: 5696 (Time: 158.8s)
Model not yet converged - Running more steps of gradient descent. Time elapsed = 9e-05s.






































Step 500 of 500; Loss: 3.9470e+04. Model Size: 5696 (Time: 107.7s)
Model not yet converged (convergence_value = 0.07675649) - Running more steps of gradient descent. Time elapsed = 0.0002s.















































Step 500 of 500; Loss: 3.7553e+04. Model Size: 5696 (Time: 154.4s)
Model not yet converged (convergence_value = 0.04856448) - Running more steps of gradient descent. Time elapsed = 0.0003s.
Traceback (most recent call last):
  File "/share/nklab/users/xz3013/CogModRNN/train_disrnn.py", line 285, in <module>
    main(args_dict,
  File "/share/nklab/users/xz3013/CogModRNN/train_disrnn.py", line 249, in main
    disrnn_params = train_model(args_dict,
  File "/share/nklab/users/xz3013/CogModRNN/train_disrnn.py", line 195, in train_model
    disrnn_params, opt_state, losses = rnn_utils.fit_model(
  File "/share/nklab/users/xz3013/CogModelingRNNsTutorial/CogModelingRNNsTutorial/rnn_utils.py", line 352, in fit_model
    params, opt_state, losses = train_model(
  File "/share/nklab/users/xz3013/CogModelingRNNsTutorial/CogModelingRNNsTutorial/rnn_utils.py", line 272, in train_model
    loss, params, opt_state = train_step(params, opt_state, xs, ys, key_i)
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 179, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/pjit.py", line 327, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr, attrs_tracked = _python_pjit_helper(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/pjit.py", line 185, in _python_pjit_helper
    out_flat = pjit_p.bind(*args_flat, **params)
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/core.py", line 2834, in bind
    return self.bind_with_trace(top_trace, args, params)
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/core.py", line 420, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/core.py", line 921, in process_primitive
    return primitive.impl(*tracers, **params)
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/pjit.py", line 1635, in _pjit_call_impl
    return xc._xla.pjit(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/pjit.py", line 1614, in call_impl_cache_miss
    out_flat, compiled = _pjit_call_impl_python(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/pjit.py", line 1536, in _pjit_call_impl_python
    compiled = _resolve_and_lower(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/pjit.py", line 1503, in _resolve_and_lower
    lowered = _pjit_lower(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/pjit.py", line 1645, in _pjit_lower
    return _pjit_lower_cached(*args, **kwargs)
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/pjit.py", line 1685, in _pjit_lower_cached
    return pxla.lower_sharding_computation(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/profiler.py", line 335, in wrapper
    return func(*args, **kwargs)
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/pxla.py", line 2253, in lower_sharding_computation
    nreps, tuple_args, shape_poly_state) = _cached_lowering_to_hlo(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/pxla.py", line 2017, in _cached_lowering_to_hlo
    lowering_result = mlir.lower_jaxpr_to_module(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/mlir.py", line 952, in lower_jaxpr_to_module
    lower_jaxpr_to_fun(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/mlir.py", line 1394, in lower_jaxpr_to_fun
    out_vals, tokens_out = jaxpr_subcomp(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/mlir.py", line 1585, in jaxpr_subcomp
    ans = lower_per_platform(rule_ctx, str(eqn.primitive),
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/mlir.py", line 1693, in lower_per_platform
    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/pjit.py", line 1842, in _pjit_lowering
    func = _pjit_cached_lower_jaxpr_to_fun(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/pjit.py", line 1825, in _pjit_cached_lower_jaxpr_to_fun
    func = mlir.lower_jaxpr_to_fun(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/mlir.py", line 1394, in lower_jaxpr_to_fun
    out_vals, tokens_out = jaxpr_subcomp(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/mlir.py", line 1585, in jaxpr_subcomp
    ans = lower_per_platform(rule_ctx, str(eqn.primitive),
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/mlir.py", line 1693, in lower_per_platform
    output = kept_rules[0](ctx, *rule_args, **rule_kwargs)
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/mlir.py", line 1794, in f_lowered
    out, tokens = jaxpr_subcomp(
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/mlir.py", line 1545, in jaxpr_subcomp
    loc = _source_info_to_location(ctx, eqn.primitive, eqn.params, source_info)
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/interpreters/mlir.py", line 402, in _source_info_to_location
    f'{core.str_eqn_compact(primitive.name, params)}')
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/core.py", line 3347, in str_eqn_compact
    kvs = " ".join(f"{k}={v}" for k, v in params.items()
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/jax/_src/core.py", line 3347, in <genexpr>
    kvs = " ".join(f"{k}={v}" for k, v in params.items()
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/numpy/core/_dtype.py", line 42, in __str__
    return dtype.name
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/numpy/core/_dtype.py", line 362, in _name_get
    if _name_includes_bit_suffix(dtype):
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/numpy/core/_dtype.py", line 339, in _name_includes_bit_suffix
    elif np.issubdtype(dtype, np.flexible) and _isunsized(dtype):
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/numpy/core/numerictypes.py", line 418, in issubdtype
    if not issubclass_(arg2, generic):
  File "/home/xz3013/.conda/envs/yolanda/lib/python3.9/site-packages/numpy/core/numerictypes.py", line 319, in issubclass_
    try:
KeyboardInterrupt